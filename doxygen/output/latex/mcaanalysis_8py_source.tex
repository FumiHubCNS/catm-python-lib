\doxysection{mcaanalysis.\+py}
\hypertarget{mcaanalysis_8py_source}{}\label{mcaanalysis_8py_source}\index{/Users/fendo/Work/Program/uv-\/python/catmlib/src/catmlib/analyser/mcaanalysis.py@{/Users/fendo/Work/Program/uv-\/python/catmlib/src/catmlib/analyser/mcaanalysis.py}}
\mbox{\hyperlink{mcaanalysis_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00001}\mbox{\hyperlink{namespacecatmlib_1_1analyser_1_1mcaanalysis}{00001}}\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00007}00007\ \textcolor{keyword}{import}\ sys}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00008}00008\ \textcolor{keyword}{import}\ os}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00010}00010\ sys.path.append(os.path.abspath(os.path.join(os.path.dirname(\_\_file\_\_),\ \textcolor{stringliteral}{'..'})))}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00012}00012\ \textcolor{keyword}{import}\ \mbox{\hyperlink{namespacecatmlib_1_1util}{catmlib.util}}\ \textcolor{keyword}{as}\ util}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00013}00013\ \textcolor{keyword}{import}\ plotly.express\ \textcolor{keyword}{as}\ px}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00014}00014\ \textcolor{keyword}{import}\ pandas\ \textcolor{keyword}{as}\ pd}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00015}00015\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00016}00016\ \textcolor{keyword}{from}\ scipy.ndimage\ \textcolor{keyword}{import}\ gaussian\_filter}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00017}00017\ \textcolor{keyword}{from}\ iminuit\ \textcolor{keyword}{import}\ Minuit}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00018}00018\ \textcolor{keyword}{from}\ iminuit.cost\ \textcolor{keyword}{import}\ LeastSquares}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00019}00019\ \textcolor{keyword}{import}\ plotly.graph\_objects\ \textcolor{keyword}{as}\ go}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00020}00020\ \textcolor{keyword}{import}\ glob}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00021}00021\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00022}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer}{00022}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer}{TMultiChannelAnalyzer}}():}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00023}00023\ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00027}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a68e99a608cfbbf4f36961772cef0764c}{00027}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a68e99a608cfbbf4f36961772cef0764c}{\_\_init\_\_}}(self):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00028}00028\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00062}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a26b5639e4fadf8b8f2a3303834bf0e9e}{00062}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a26b5639e4fadf8b8f2a3303834bf0e9e}{Qmeas}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00063}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a22c6b320ff96ba0091cfbcc603951dfc}{00063}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a22c6b320ff96ba0091cfbcc603951dfc}{Qmeas\_err}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00064}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ad5d5cb6885e3c195aa10577ed87ac570}{00064}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ad5d5cb6885e3c195aa10577ed87ac570}{dEdX}}\ =\ 1e6\ \ \ \ \textcolor{comment}{\#\ [eV/mm]}}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00065}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ab20bd9590ea60578e6fca8d3558f0c3a}{00065}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ab20bd9590ea60578e6fca8d3558f0c3a}{dL}}\ =\ 12\ \ \ \ \ \ \ \textcolor{comment}{\#\ [mm]}}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00066}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a10c9fe8188da7fcf9d6b7dbcaca84e26}{00066}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a10c9fe8188da7fcf9d6b7dbcaca84e26}{W}}\ =\ 26\ \ \ \ \ \ \ \ \textcolor{comment}{\#\ [eV]}}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00067}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ad0c1cd4358cfb4e03e7c689edcc8e9d0}{00067}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ad0c1cd4358cfb4e03e7c689edcc8e9d0}{Qe}}\ =\ 1.602e-\/7\ \textcolor{comment}{\#\ [pC]}}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00068}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a7c3020e476ac1e1d25358d8a3b49f103}{00068}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a7c3020e476ac1e1d25358d8a3b49f103}{G}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00069}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a66b915780d1e66c39030fb17deea07da}{00069}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a66b915780d1e66c39030fb17deea07da}{G\_err}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00070}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a9e9fe17532f38716e43e5f33e6befd22}{00070}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a9e9fe17532f38716e43e5f33e6befd22}{E}}\ =\ 1\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00071}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a5d7ba8bf9fe88a46f32e506986b85cbe}{00071}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a5d7ba8bf9fe88a46f32e506986b85cbe}{a}}\ =\ 1}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00072}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_abefc13372000ebe1b0efda1bce9463bb}{00072}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_abefc13372000ebe1b0efda1bce9463bb}{b}}\ =\ 0}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00073}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a83b9349d88bd1605ff04548bbfab885b}{00073}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a83b9349d88bd1605ff04548bbfab885b}{calib\_path}}\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00074}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a505ceb4c405c28be601bccfc4cdd013d}{00074}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a505ceb4c405c28be601bccfc4cdd013d}{datas}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00075}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae5bc04a75161c96e9a7b837eafc19690}{00075}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae5bc04a75161c96e9a7b837eafc19690}{input\_values}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00076}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ac4305e6ff8e753cb9519a866b9112eea}{00076}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ac4305e6ff8e753cb9519a866b9112eea}{calib\_fit\_xs}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00077}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a4fa940db1824cd02bce1496c70c9fc5e}{00077}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a4fa940db1824cd02bce1496c70c9fc5e}{calib\_fit\_ys}}\ =[]}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00078}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a53e658c8ddbd4b2ef4e4f0215e065c59}{00078}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a53e658c8ddbd4b2ef4e4f0215e065c59}{calib\_means}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00079}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a130beccd1a9c5d55952af70fba3474ce}{00079}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a130beccd1a9c5d55952af70fba3474ce}{calib\_sigmas}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00080}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a434e33f4a51d1ee041722c432f6c9102}{00080}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a434e33f4a51d1ee041722c432f6c9102}{data\_files}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00081}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a38cc24d5af4ef806ab65318c4aaf796d}{00081}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a38cc24d5af4ef806ab65318c4aaf796d}{data\_files\_name}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00082}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae446d05f6a53db6956f33bea1c78d815}{00082}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae446d05f6a53db6956f33bea1c78d815}{datas\_x}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00083}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ab028ae4af8dffb065deae908c19d0643}{00083}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ab028ae4af8dffb065deae908c19d0643}{datas\_y}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00084}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a7643c500c963ba6dcdfa86aa273f8426}{00084}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a7643c500c963ba6dcdfa86aa273f8426}{datas\_h}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00085}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a5642e4e18248da0e9a45194643a9f63f}{00085}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a5642e4e18248da0e9a45194643a9f63f}{datas\_peak\_count}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00086}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae3177584f4420964d3ed6a0c369c9fb2}{00086}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae3177584f4420964d3ed6a0c369c9fb2}{datas\_peak\_indices}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00087}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae0b4629d635715a95dc81941afc8cc5d}{00087}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae0b4629d635715a95dc81941afc8cc5d}{datas\_fit\_xs}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00088}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a4c25699507abbc7d92b9d880472fe99a}{00088}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a4c25699507abbc7d92b9d880472fe99a}{datas\_fit\_ys}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00089}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a5fd6c42030b318ebd0f3fa66008a7119}{00089}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a5fd6c42030b318ebd0f3fa66008a7119}{datas\_fit\_oys}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00090}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a8445025b1ec1d48cd311e101dfc0d43d}{00090}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a8445025b1ec1d48cd311e101dfc0d43d}{datas\_means}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00091}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a9c913eb218cb3b3997909837fe51d684}{00091}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a9c913eb218cb3b3997909837fe51d684}{datas\_sigmas}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00092}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ac7ec4c3e66f37706b483e8e0ae322569}{00092}}\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ac7ec4c3e66f37706b483e8e0ae322569}{voltages}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00093}00093\ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00094}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a686b74ecea6effbbb3f5000b050c01a4}{00094}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a686b74ecea6effbbb3f5000b050c01a4}{get\_Qmeas}}(self):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00095}00095\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00098}00098\ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a26b5639e4fadf8b8f2a3303834bf0e9e}{Qmeas}},\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a22c6b320ff96ba0091cfbcc603951dfc}{Qmeas\_err}}}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00099}00099\ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00100}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a312cd90663db8c349893e45d42c87ccf}{00100}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a312cd90663db8c349893e45d42c87ccf}{get\_Gain}}(self):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00101}00101\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00104}00104\ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a7c3020e476ac1e1d25358d8a3b49f103}{G}},\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a66b915780d1e66c39030fb17deea07da}{G\_err}}}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00105}00105\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00106}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a92e9fb4bf16d71b1223ca30ae8125827}{00106}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a92e9fb4bf16d71b1223ca30ae8125827}{set\_voltages}}(self,\ val):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00107}00107\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00111}00111\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ac7ec4c3e66f37706b483e8e0ae322569}{voltages}}\ =\ val}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00112}00112\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00113}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a0dafa367e0f6b71f3d0eac03710c34b9}{00113}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a0dafa367e0f6b71f3d0eac03710c34b9}{set\_dEdX}}(self,\ val):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00114}00114\ \ \ \ \ \textcolor{comment}{\#\ @brief\ set\ energy\ loss\ in\ small\ interval\ at\ certain\ point}}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00115}00115\ \ \ \ \ \textcolor{comment}{\#\ @param\ val\ reference\ values\ }}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00116}00116\ \ \ \ \ \textcolor{comment}{\#\ @return\ None}}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00117}00117\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ad5d5cb6885e3c195aa10577ed87ac570}{dEdX}}\ =\ val\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00118}00118\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00119}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a8ca26b603c7895ba65002ddd48436a2b}{00119}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a8ca26b603c7895ba65002ddd48436a2b}{set\_dL}}(self,\ val):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00120}00120\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00124}00124\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ab20bd9590ea60578e6fca8d3558f0c3a}{dL}}\ =\ val}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00125}00125\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00126}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae96426d1ee09ce4abe023f3c47f137b9}{00126}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae96426d1ee09ce4abe023f3c47f137b9}{set\_W}}(self,\ val):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00127}00127\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00131}00131\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a10c9fe8188da7fcf9d6b7dbcaca84e26}{W}}\ =\ val}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00132}00132\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00133}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a3ea4c90ff287ee262c3e86edc78649ac}{00133}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a3ea4c90ff287ee262c3e86edc78649ac}{calculate\_Qmeas}}(self):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00134}00134\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00141}00141\ \ \ \ \ \textcolor{keywordflow}{if}\ len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a8445025b1ec1d48cd311e101dfc0d43d}{datas\_means}})*len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a9c913eb218cb3b3997909837fe51d684}{datas\_sigmas}})>0:}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00142}00142\ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a26b5639e4fadf8b8f2a3303834bf0e9e}{Qmeas}}\ =\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_acbbee1f993454e13253f9472defcfadc}{linear}}(\ np.array(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a8445025b1ec1d48cd311e101dfc0d43d}{datas\_means}}).flatten(),\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_abefc13372000ebe1b0efda1bce9463bb}{b}},\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a5d7ba8bf9fe88a46f32e506986b85cbe}{a}})}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00143}00143\ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a22c6b320ff96ba0091cfbcc603951dfc}{Qmeas\_err}}\ =\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a5d7ba8bf9fe88a46f32e506986b85cbe}{a}}\ *\ np.array(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a9c913eb218cb3b3997909837fe51d684}{datas\_sigmas}}).flatten()}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00144}00144\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00145}00145\ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{'measured\ values\ are\ empty.'})\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00146}00146\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00147}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a54ada8110eaef5f1c01e157a9726e47c}{00147}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a54ada8110eaef5f1c01e157a9726e47c}{calculate\_Gain}}(self):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00148}00148\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00155}00155\ \ \ \ \ \textcolor{keywordflow}{if}\ len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a26b5639e4fadf8b8f2a3303834bf0e9e}{Qmeas}})*len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a22c6b320ff96ba0091cfbcc603951dfc}{Qmeas\_err}})>0:}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00156}00156\ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a7c3020e476ac1e1d25358d8a3b49f103}{G}}\ =\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a26b5639e4fadf8b8f2a3303834bf0e9e}{Qmeas}}\ /\ (\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ad5d5cb6885e3c195aa10577ed87ac570}{dEdX}}\ *\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ab20bd9590ea60578e6fca8d3558f0c3a}{dL}}\ *\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ad0c1cd4358cfb4e03e7c689edcc8e9d0}{Qe}}\ /\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a10c9fe8188da7fcf9d6b7dbcaca84e26}{W}}\ )\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00157}00157\ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a66b915780d1e66c39030fb17deea07da}{G\_err}}\ =\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a22c6b320ff96ba0091cfbcc603951dfc}{Qmeas\_err}}\ /\ (\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ad5d5cb6885e3c195aa10577ed87ac570}{dEdX}}\ *\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ab20bd9590ea60578e6fca8d3558f0c3a}{dL}}\ *\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ad0c1cd4358cfb4e03e7c689edcc8e9d0}{Qe}}\ /\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a10c9fe8188da7fcf9d6b7dbcaca84e26}{W}}\ )\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00158}00158\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00159}00159\ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{'measured\ values\ are\ empty.'})\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00160}00160\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00161}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_af56e284882ffb6edc2b4b63aa4b84ea8}{00161}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_af56e284882ffb6edc2b4b63aa4b84ea8}{gaussian}}(self,\ x,\ amplitude,\ mean,\ sigma):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00162}00162\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00168}00168\ \ \ \ \ \textcolor{keywordflow}{return}\ amplitude\ *\ np.exp(-\/0.5\ *\ ((x\ -\/\ mean)\ /\ sigma)\ **\ 2)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00169}00169\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00170}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_acbbee1f993454e13253f9472defcfadc}{00170}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_acbbee1f993454e13253f9472defcfadc}{linear}}(self,\ x,\ p0,\ p1):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00171}00171\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00177}00177\ \ \ \ \ \textcolor{keywordflow}{return}\ p0\ +\ p1\ *\ x}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00178}00178\ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00179}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_aa420285eb094bcdbdba98ed689004800}{00179}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_aa420285eb094bcdbdba98ed689004800}{set\_calibration\_file\_path}}(self,\ file\_path):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00180}00180\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00184}00184\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a83b9349d88bd1605ff04548bbfab885b}{calib\_path}}\ =\ file\_path}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00185}00185\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00186}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_aa26f327f5d74521ffc302d02396aa309}{00186}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_aa26f327f5d74521ffc302d02396aa309}{set\_input\_values}}(self,\ values):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00187}00187\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00191}00191\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae5bc04a75161c96e9a7b837eafc19690}{input\_values}}\ =\ values}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00192}00192\ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00193}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_af767d7af60cacab14955ba8c127bae01}{00193}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_af767d7af60cacab14955ba8c127bae01}{find\_peak}}(self,\ smooth\_parameter=3,\ input\_label='calib'\ ,debug=False):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00194}00194\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00205}00205\ \ \ \ \ \textcolor{keywordflow}{if}\ input\_label\ ==\ \textcolor{stringliteral}{'calib'}:}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00206}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a9486ee23f04ebee079448a36d0de3d14}{00206}}\ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a9486ee23f04ebee079448a36d0de3d14}{calib\_data\_x}},\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a06fa36e8437c086663706828b3c2a8f5}{calib\_data\_y}}\ =\ util.dataforming.read\_spe\_file(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a83b9349d88bd1605ff04548bbfab885b}{calib\_path}})}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00207}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ab5de031b2c4b7a4189b4956fae36fccb}{00207}}\ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ab5de031b2c4b7a4189b4956fae36fccb}{calib\_data\_h}}\ =\ util.dataforming.create\_histogram\_data\_from\_points(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a9486ee23f04ebee079448a36d0de3d14}{calib\_data\_x}},\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a06fa36e8437c086663706828b3c2a8f5}{calib\_data\_y}})}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00208}00208\ \ \ \ \ \ \ smoothed\_data\ =\ gaussian\_filter(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a06fa36e8437c086663706828b3c2a8f5}{calib\_data\_y}},\ smooth\_parameter)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00209}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a200466ca9d3a7493adcdfe9e3f077f2b}{00209}}\ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a200466ca9d3a7493adcdfe9e3f077f2b}{calib\_data\_peak\_count}},\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ab0b4d5c3a1a193341e0c73fdae054cdc}{calib\_data\_peak\_indices}}\ =\ util.dataforming.find\_peaks(smoothed\_data)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00210}00210\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00211}00211\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ debug:}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00212}00212\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}(calibration)\ number\ of\ peak:"{}},\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a200466ca9d3a7493adcdfe9e3f077f2b}{calib\_data\_peak\_count}},\textcolor{stringliteral}{"{},\ index\ of\ peak:"{}},\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ab0b4d5c3a1a193341e0c73fdae054cdc}{calib\_data\_peak\_indices}})}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00213}00213\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00214}00214\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00215}00215\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a434e33f4a51d1ee041722c432f6c9102}{data\_files}})):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00216}00216\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00217}00217\ \ \ \ \ \ \ \ \ file\_name\ =\ os.path.basename(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a434e33f4a51d1ee041722c432f6c9102}{data\_files}}[i])}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00218}00218\ \ \ \ \ \ \ \ \ data\_x,\ data\_y\ =\ util.dataforming.read\_spe\_file(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a434e33f4a51d1ee041722c432f6c9102}{data\_files}}[i])}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00219}00219\ \ \ \ \ \ \ \ \ data\_h\ =\ util.dataforming.create\_histogram\_data\_from\_points(data\_x,\ data\_y)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00220}00220\ \ \ \ \ \ \ \ \ smoothed\_data\ =\ gaussian\_filter(data\_y,\ smooth\_parameter)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00221}00221\ \ \ \ \ \ \ \ \ data\_peak\_count,\ data\_peak\_indices\ =\ util.dataforming.find\_peaks(smoothed\_data)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00222}00222\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00223}00223\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae446d05f6a53db6956f33bea1c78d815}{datas\_x}}.append(data\_x)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00224}00224\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ab028ae4af8dffb065deae908c19d0643}{datas\_y}}.append(data\_y)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00225}00225\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a7643c500c963ba6dcdfa86aa273f8426}{datas\_h}}.append(data\_h)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00226}00226\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a5642e4e18248da0e9a45194643a9f63f}{datas\_peak\_count}}.append(data\_peak\_count)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00227}00227\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae3177584f4420964d3ed6a0c369c9fb2}{datas\_peak\_indices}}.append(data\_peak\_indices)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00228}00228\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a38cc24d5af4ef806ab65318c4aaf796d}{data\_files\_name}}.append(os.path.splitext(file\_name)[0])}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00229}00229\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00230}00230\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ debug:}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00231}00231\ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}(data)\ :"{}},\ i,\ \textcolor{stringliteral}{"{}\ number\ of\ peak:"{}},\ data\_peak\_count,\ \textcolor{stringliteral}{"{},\ index\ of\ peak:"{}},\ data\_peak\_indices)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00232}00232\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00233}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a3e0d7858932b1010c54c0c7187e652cf}{00233}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a3e0d7858932b1010c54c0c7187e652cf}{fit\_calibration\_data}}(self,\ width=30,\ initial\_sigma=10,\ plot\_flag=False):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00234}00234\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00244}00244\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ab0b4d5c3a1a193341e0c73fdae054cdc}{calib\_data\_peak\_indices}})):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00245}00245\ \ \ \ \ \ \ xarr\ =\ np.array(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a9486ee23f04ebee079448a36d0de3d14}{calib\_data\_x}})}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00246}00246\ \ \ \ \ \ \ yarr\ =\ np.array(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a06fa36e8437c086663706828b3c2a8f5}{calib\_data\_y}})}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00247}00247\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00248}00248\ \ \ \ \ \ \ fit\_min,\ fit\_max\ =\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a9486ee23f04ebee079448a36d0de3d14}{calib\_data\_x}}[self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ab0b4d5c3a1a193341e0c73fdae054cdc}{calib\_data\_peak\_indices}}[i]]\ -\/\ width,\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a9486ee23f04ebee079448a36d0de3d14}{calib\_data\_x}}[self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ab0b4d5c3a1a193341e0c73fdae054cdc}{calib\_data\_peak\_indices}}[i]]\ +\ width\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00249}00249\ \ \ \ \ \ \ mask\ =\ (xarr\ >=\ fit\_min)\ \&\ (xarr\ <=\ fit\_max)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00250}00250\ \ \ \ \ \ \ xarr\_mask\ =\ xarr[mask]}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00251}00251\ \ \ \ \ \ \ yarr\_mask\ =\ yarr[mask]}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00252}00252\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00253}00253\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00254}00254\ \ \ \ \ \ \ least\_squares\ =\ LeastSquares(xarr\_mask,\ yarr\_mask,\ np.ones\_like(yarr\_mask),\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_af56e284882ffb6edc2b4b63aa4b84ea8}{gaussian}})}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00255}00255\ \ \ \ \ \ \ m\ =\ Minuit(least\_squares,\ amplitude=self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a06fa36e8437c086663706828b3c2a8f5}{calib\_data\_y}}[self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ab0b4d5c3a1a193341e0c73fdae054cdc}{calib\_data\_peak\_indices}}[i]],\ \ mean=self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a9486ee23f04ebee079448a36d0de3d14}{calib\_data\_x}}[self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ab0b4d5c3a1a193341e0c73fdae054cdc}{calib\_data\_peak\_indices}}[i]],\ sigma=initial\_sigma)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00256}00256\ \ \ \ \ \ \ m.errordef\ =\ 1}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00257}00257\ \ \ \ \ \ \ m.migrad()}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00258}00258\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00259}00259\ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ac4305e6ff8e753cb9519a866b9112eea}{calib\_fit\_xs}}.append(xarr\_mask)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00260}00260\ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a4fa940db1824cd02bce1496c70c9fc5e}{calib\_fit\_ys}}.append(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_af56e284882ffb6edc2b4b63aa4b84ea8}{gaussian}}(xarr\_mask,\ m.values[\textcolor{stringliteral}{'amplitude'}],\ m.values[\textcolor{stringliteral}{'mean'}],\ m.values[\textcolor{stringliteral}{'sigma'}]))}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00261}00261\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00262}00262\ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a53e658c8ddbd4b2ef4e4f0215e065c59}{calib\_means}}.append(m.values[\textcolor{stringliteral}{'mean'}])}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00263}00263\ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a130beccd1a9c5d55952af70fba3474ce}{calib\_sigmas}}.append(m.values[\textcolor{stringliteral}{'sigma'}])}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00264}00264\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00265}00265\ \ \ \ \ \textcolor{keywordflow}{if}\ plot\_flag:}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00266}00266\ \ \ \ \ \ \ categories\ =\ [\textcolor{stringliteral}{"{}mca"{}}]\ *\ len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ab5de031b2c4b7a4189b4956fae36fccb}{calib\_data\_h}})\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00267}00267\ \ \ \ \ \ \ df\ =\ pd.DataFrame(\{\textcolor{stringliteral}{'Value'}:\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ab5de031b2c4b7a4189b4956fae36fccb}{calib\_data\_h}},\ \textcolor{stringliteral}{'Category'}:\ categories\})}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00268}00268\ \ \ \ \ \ \ fig\ =\ px.histogram(df,\ x=\textcolor{stringliteral}{'Value'},\ color=\textcolor{stringliteral}{'Category'},\ nbins=1023,\ labels=\{\textcolor{stringliteral}{'Value'}:\ \textcolor{stringliteral}{'Channel'}\},\ title=\textcolor{stringliteral}{'MCA\ Histogram'})}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00269}00269\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00270}00270\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a53e658c8ddbd4b2ef4e4f0215e065c59}{calib\_means}})):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00271}00271\ \ \ \ \ \ \ \ \ \ \ fig.add\_trace(}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00272}00272\ \ \ \ \ \ \ \ \ \ \ \ \ go.Scatter(}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00273}00273\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x=self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ac4305e6ff8e753cb9519a866b9112eea}{calib\_fit\_xs}}[i],\ y=self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a4fa940db1824cd02bce1496c70c9fc5e}{calib\_fit\_ys}}[i],\ mode=\textcolor{stringliteral}{'lines'},\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00274}00274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ name=f\textcolor{stringliteral}{"{}FID:\{i\},\ (\{self.calib\_means[i]:3.2f\},\ \{self.calib\_sigmas[i]:3.2f\})"{}},\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00275}00275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ line=dict(color=\textcolor{stringliteral}{'red'},\ width=1.5),\ opacity=0.5))}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00276}00276\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00277}00277\ \ \ \ \ \ \ fig.show()}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00278}00278\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00279}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a375c8936a662748b7af17995345045c8}{00279}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a375c8936a662748b7af17995345045c8}{calculate\_calibration\_parameters}}(self,\ plot\_flag=False):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00280}00280\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00288}00288\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00289}00289\ \ \ \ \ \textcolor{comment}{\#\ @param\ plot\_flag\ plot\ flag.\ if\ true,\ draw\ data\ by\ plotly\ (default:False)}}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00290}00290\ \ \ \ \ \textcolor{comment}{\#\ @return\ None}}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00291}00291\ \ \ \ \ \textcolor{keywordflow}{if}\ len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a130beccd1a9c5d55952af70fba3474ce}{calib\_sigmas}})\ ==\ len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae5bc04a75161c96e9a7b837eafc19690}{input\_values}}):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00292}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a5cf2a0020ecdfb9c083897ca1c8b3fce}{00292}}\ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a5cf2a0020ecdfb9c083897ca1c8b3fce}{calib\_means\_err}}\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00293}00293\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a53e658c8ddbd4b2ef4e4f0215e065c59}{calib\_means}})):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00294}00294\ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a5cf2a0020ecdfb9c083897ca1c8b3fce}{calib\_means\_err}}.append(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a130beccd1a9c5d55952af70fba3474ce}{calib\_sigmas}}[i]/self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a53e658c8ddbd4b2ef4e4f0215e065c59}{calib\_means}}[i])}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00295}00295\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00296}00296\ \ \ \ \ \ \ least\_squares\ =\ LeastSquares(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae5bc04a75161c96e9a7b837eafc19690}{input\_values}},\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a53e658c8ddbd4b2ef4e4f0215e065c59}{calib\_means}},\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a5cf2a0020ecdfb9c083897ca1c8b3fce}{calib\_means\_err}},\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_acbbee1f993454e13253f9472defcfadc}{linear}})}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00297}00297\ \ \ \ \ \ \ m\ =\ Minuit(least\_squares,\ p0=0,\ p1=100)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00298}00298\ \ \ \ \ \ \ m.errordef\ =\ 1}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00299}00299\ \ \ \ \ \ \ m.migrad()}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00300}00300\ \ \ \ \ \ \ params\ =\ m.values}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00301}00301\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00302}00302\ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_abefc13372000ebe1b0efda1bce9463bb}{b}}\ =\ -\/params[\textcolor{stringliteral}{'p0'}]/params[\textcolor{stringliteral}{'p1'}]}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00303}00303\ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a5d7ba8bf9fe88a46f32e506986b85cbe}{a}}\ =\ 1/params[\textcolor{stringliteral}{'p1'}]\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00304}00304\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00305}00305\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ plot\_flag:}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00306}00306\ \ \ \ \ \ \ \ \ fig\ =\ go.Figure(}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00307}00307\ \ \ \ \ \ \ \ \ \ \ data\ =\ go.Scatter(}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00308}00308\ \ \ \ \ \ \ \ \ \ \ \ \ y=self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae5bc04a75161c96e9a7b837eafc19690}{input\_values}},\ x=self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a53e658c8ddbd4b2ef4e4f0215e065c59}{calib\_means}},\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00309}00309\ \ \ \ \ \ \ \ \ \ \ \ \ error\_x=dict(type=\textcolor{stringliteral}{'data'},\ array=self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a5cf2a0020ecdfb9c083897ca1c8b3fce}{calib\_means\_err}},\ thickness=2,\ width=5,\ visible=\textcolor{keyword}{True}),}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00310}00310\ \ \ \ \ \ \ \ \ \ \ \ \ mode=\textcolor{stringliteral}{'markers'},\ name=\textcolor{stringliteral}{'fitted\ data\ plot'}))}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00311}00311\ \ \ \ \ \ \ \ \ fig.update\_layout(title=\textcolor{stringliteral}{'Input\ Values\ vs\ Fitted\ Values'},\ yaxis\_title=\textcolor{stringliteral}{'Input\ values'},\ xaxis\_title=\textcolor{stringliteral}{'Fitted\ value'},\ title\_x=0.05,\ title\_font=dict(size=20))}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00312}00312\ \ \ \ \ \ \ \ \ fig.add\_trace(}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00313}00313\ \ \ \ \ \ \ \ \ \ \ go.Scatter(}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00314}00314\ \ \ \ \ \ \ \ \ \ \ \ \ x=np.array(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a53e658c8ddbd4b2ef4e4f0215e065c59}{calib\_means}}),\ y=self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_acbbee1f993454e13253f9472defcfadc}{linear}}(np.array(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a53e658c8ddbd4b2ef4e4f0215e065c59}{calib\_means}}),\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_abefc13372000ebe1b0efda1bce9463bb}{b}}\ ,\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a5d7ba8bf9fe88a46f32e506986b85cbe}{a}}),\ mode=\textcolor{stringliteral}{'lines'},\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00315}00315\ \ \ \ \ \ \ \ \ \ \ \ \ name=f\textcolor{stringliteral}{"{}\{self.b:.3f\}+\{self.a:.3f\}x"{}},\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00316}00316\ \ \ \ \ \ \ \ \ \ \ \ \ line=dict(color=\textcolor{stringliteral}{'red'},\ width=2),\ opacity=0.5))}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00317}00317\ \ \ \ \ \ \ \ \ fig.show()}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00318}00318\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00319}00319\ \ \ \ \ \ \ print(\textcolor{stringliteral}{'peak\ number\ does\ not\ match\ input\ list.'})}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00320}00320\ \ \ \ \ \ \ print(\textcolor{stringliteral}{'calibration\ parameter\ calculation\ process\ wad\ skipped.'})}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00321}00321\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00322}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a170e769125666d78312a8584f1aed3eb}{00322}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a170e769125666d78312a8584f1aed3eb}{remove\_fitted\_peak}}(self,\ list\_label='calib',\ index\_list=[]):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00323}00323\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00328}00328\ \ \ \ \ \textcolor{keywordflow}{if}\ list\_label\ ==\ \textcolor{stringliteral}{'calib'}:}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00329}00329\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ index\ \textcolor{keywordflow}{in}\ sorted(index\_list,\ reverse=\textcolor{keyword}{True}):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00330}00330\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ 0\ <=\ index\ <\ len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a130beccd1a9c5d55952af70fba3474ce}{calib\_sigmas}}):\ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00331}00331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ del\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a130beccd1a9c5d55952af70fba3474ce}{calib\_sigmas}}[index]}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00332}00332\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00333}00333\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ index\ \textcolor{keywordflow}{in}\ sorted(index\_list,\ reverse=\textcolor{keyword}{True}):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00334}00334\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ 0\ <=\ index\ <\ len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a53e658c8ddbd4b2ef4e4f0215e065c59}{calib\_means}}):\ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00335}00335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ del\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a53e658c8ddbd4b2ef4e4f0215e065c59}{calib\_means}}[index]}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00336}00336\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00337}00337\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a8445025b1ec1d48cd311e101dfc0d43d}{datas\_means}})):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00338}00338\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ index\ \textcolor{keywordflow}{in}\ sorted(index\_list[i],\ reverse=\textcolor{keyword}{True}):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00339}00339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ 0\ <=\ index\ <\ len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae0b4629d635715a95dc81941afc8cc5d}{datas\_fit\_xs}}[i]):\ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00340}00340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ del\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae0b4629d635715a95dc81941afc8cc5d}{datas\_fit\_xs}}[i][index]}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00341}00341\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00342}00342\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ index\ \textcolor{keywordflow}{in}\ sorted(index\_list[i],\ reverse=\textcolor{keyword}{True}):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00343}00343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ 0\ <=\ index\ <\ len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a4c25699507abbc7d92b9d880472fe99a}{datas\_fit\_ys}}[i]):\ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00344}00344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ del\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a4c25699507abbc7d92b9d880472fe99a}{datas\_fit\_ys}}[i][index]}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00345}00345\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00346}00346\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ index\ \textcolor{keywordflow}{in}\ sorted(index\_list[i],\ reverse=\textcolor{keyword}{True}):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00347}00347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ 0\ <=\ index\ <\ len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a5fd6c42030b318ebd0f3fa66008a7119}{datas\_fit\_oys}}[i]):\ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00348}00348\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ del\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a5fd6c42030b318ebd0f3fa66008a7119}{datas\_fit\_oys}}[i][index]}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00349}00349\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00350}00350\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ index\ \textcolor{keywordflow}{in}\ sorted(index\_list[i],\ reverse=\textcolor{keyword}{True}):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00351}00351\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ 0\ <=\ index\ <\ len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a8445025b1ec1d48cd311e101dfc0d43d}{datas\_means}}[i]):\ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00352}00352\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ del\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a8445025b1ec1d48cd311e101dfc0d43d}{datas\_means}}[i][index]}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00353}00353\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00354}00354\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ index\ \textcolor{keywordflow}{in}\ sorted(index\_list[i],\ reverse=\textcolor{keyword}{True}):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00355}00355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ 0\ <=\ index\ <\ len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a9c913eb218cb3b3997909837fe51d684}{datas\_sigmas}}[i]):\ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00356}00356\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ del\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a9c913eb218cb3b3997909837fe51d684}{datas\_sigmas}}[i][index]}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00357}00357\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00358}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a3d5f7c7ed22f86e05949d4bb597e8cdd}{00358}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a3d5f7c7ed22f86e05949d4bb597e8cdd}{get\_data\_file\_path\_list}}(self,\ filepath='./*spe'):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00359}00359\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00367}00367\ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a434e33f4a51d1ee041722c432f6c9102}{data\_files}}\ =\ sorted(glob.glob(filepath))}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00368}00368\ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00369}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a9a7c848c6f8d231f57951eaa82371309}{00369}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a9a7c848c6f8d231f57951eaa82371309}{add\_data\_file\_path\_list}}(self,\ filepath='./*spe'):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00370}00370\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00378}00378\ \ \ \ \ add\_files\ =\ sorted(glob.glob(filepath))}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00379}00379\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(add\_files)):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00380}00380\ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a434e33f4a51d1ee041722c432f6c9102}{data\_files}}.append(add\_files[i])}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00381}00381\ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00382}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a8bedc887ec3de0f7b50e361a391313cc}{00382}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a8bedc887ec3de0f7b50e361a391313cc}{check\_data\_file}}(self):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00383}00383\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00386}00386\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a434e33f4a51d1ee041722c432f6c9102}{data\_files}})):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00387}00387\ \ \ \ \ \ \ print(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a434e33f4a51d1ee041722c432f6c9102}{data\_files}}[i])}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00388}00388\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00389}00389\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00390}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a40cb95c444fc86dd287b7233a17e0a25}{00390}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a40cb95c444fc86dd287b7233a17e0a25}{fit\_data}}(self,\ width=30,\ initial\_sigma=10):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00391}00391\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00400}00400\ \ \ \ \ \textcolor{keywordflow}{for}\ j\ \textcolor{keywordflow}{in}\ range(len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae446d05f6a53db6956f33bea1c78d815}{datas\_x}})):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00401}00401\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00402}00402\ \ \ \ \ \ \ data\_fit\_xs\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00403}00403\ \ \ \ \ \ \ data\_fit\_ys\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00404}00404\ \ \ \ \ \ \ data\_fit\_oys\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00405}00405\ \ \ \ \ \ \ data\_means\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00406}00406\ \ \ \ \ \ \ data\_sigmas\ =\ []}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00407}00407\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00408}00408\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae3177584f4420964d3ed6a0c369c9fb2}{datas\_peak\_indices}}[j])):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00409}00409\ \ \ \ \ \ \ \ \ xarr\ =\ np.array(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae446d05f6a53db6956f33bea1c78d815}{datas\_x}}[j])}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00410}00410\ \ \ \ \ \ \ \ \ yarr\ =\ np.array(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ab028ae4af8dffb065deae908c19d0643}{datas\_y}}[j])}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00411}00411\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00412}00412\ \ \ \ \ \ \ \ \ fit\_min,\ fit\_max\ =\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae446d05f6a53db6956f33bea1c78d815}{datas\_x}}[j][self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae3177584f4420964d3ed6a0c369c9fb2}{datas\_peak\_indices}}[j][i]]\ -\/\ width,\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae446d05f6a53db6956f33bea1c78d815}{datas\_x}}[j][self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae3177584f4420964d3ed6a0c369c9fb2}{datas\_peak\_indices}}[j][i]]\ +\ width\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00413}00413\ \ \ \ \ \ \ \ \ mask\ =\ (xarr\ >=\ fit\_min)\ \&\ (xarr\ <=\ fit\_max)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00414}00414\ \ \ \ \ \ \ \ \ xarr\_mask\ =\ xarr[mask]}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00415}00415\ \ \ \ \ \ \ \ \ yarr\_mask\ =\ yarr[mask]}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00416}00416\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00417}00417\ \ \ \ \ \ \ \ \ least\_squares\ =\ LeastSquares(xarr\_mask,\ yarr\_mask,\ np.ones\_like(yarr\_mask),\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_af56e284882ffb6edc2b4b63aa4b84ea8}{gaussian}})}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00418}00418\ \ \ \ \ \ \ \ \ m\ =\ Minuit(least\_squares,\ amplitude=self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ab028ae4af8dffb065deae908c19d0643}{datas\_y}}[j][self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae3177584f4420964d3ed6a0c369c9fb2}{datas\_peak\_indices}}[j][i]],\ \ mean=self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae446d05f6a53db6956f33bea1c78d815}{datas\_x}}[j][self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae3177584f4420964d3ed6a0c369c9fb2}{datas\_peak\_indices}}[j][i]],\ sigma=initial\_sigma)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00419}00419\ \ \ \ \ \ \ \ \ m.errordef\ =\ 1}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00420}00420\ \ \ \ \ \ \ \ \ m.migrad()}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00421}00421\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00422}00422\ \ \ \ \ \ \ \ \ data\_fit\_xs.append(xarr\_mask)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00423}00423\ \ \ \ \ \ \ \ \ data\_fit\_ys.append(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_af56e284882ffb6edc2b4b63aa4b84ea8}{gaussian}}(xarr\_mask,\ m.values[\textcolor{stringliteral}{'amplitude'}],\ m.values[\textcolor{stringliteral}{'mean'}],\ m.values[\textcolor{stringliteral}{'sigma'}]))}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00424}00424\ \ \ \ \ \ \ \ \ data\_fit\_oys.append(yarr\_mask)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00425}00425\ \ \ \ \ \ \ \ \ data\_means.append(m.values[\textcolor{stringliteral}{'mean'}])}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00426}00426\ \ \ \ \ \ \ \ \ data\_sigmas.append(m.values[\textcolor{stringliteral}{'sigma'}])}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00427}00427\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00428}00428\ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae0b4629d635715a95dc81941afc8cc5d}{datas\_fit\_xs}}.append(data\_fit\_xs)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00429}00429\ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a4c25699507abbc7d92b9d880472fe99a}{datas\_fit\_ys}}.append(data\_fit\_ys)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00430}00430\ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a5fd6c42030b318ebd0f3fa66008a7119}{datas\_fit\_oys}}.append(data\_fit\_oys)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00431}00431\ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a8445025b1ec1d48cd311e101dfc0d43d}{datas\_means}}.append(data\_means)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00432}00432\ \ \ \ \ \ \ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a9c913eb218cb3b3997909837fe51d684}{datas\_sigmas}}.append(data\_sigmas)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00433}00433\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00434}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a99b8f1035c8851ef70115a8d3458534a}{00434}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a99b8f1035c8851ef70115a8d3458534a}{draw\_fitted\_datas}}(self):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00435}00435\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00438}00438\ \ \ \ \ k\ =\ 0}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00439}00439\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00440}00440\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae0b4629d635715a95dc81941afc8cc5d}{datas\_fit\_xs}})):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00441}00441\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ j\ \textcolor{keywordflow}{in}\ range(len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae0b4629d635715a95dc81941afc8cc5d}{datas\_fit\_xs}}[i])):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00442}00442\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00443}00443\ \ \ \ \ \ \ \ \ data\_h\ =\ util.dataforming.create\_histogram\_data\_from\_points(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae0b4629d635715a95dc81941afc8cc5d}{datas\_fit\_xs}}[i][j],\ self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a5fd6c42030b318ebd0f3fa66008a7119}{datas\_fit\_oys}}[i][j])}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00444}00444\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00445}00445\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ k\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00446}00446\ \ \ \ \ \ \ \ \ \ \ categories\ =\ [f\textcolor{stringliteral}{"{}\{self.data\_files\_name[i]\},\ FID:\{i\},\ HID:\{j\}"{}}]\ *\ len(data\_h)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00447}00447\ \ \ \ \ \ \ \ \ \ \ histograms\ =\ data\_h}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00448}00448\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00449}00449\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00450}00450\ \ \ \ \ \ \ \ \ \ \ categories\ =\ categories\ +\ [f\textcolor{stringliteral}{"{}\{self.data\_files\_name[i]\},\ FID:\{i\},\ HID:\{j\}"{}}]\ *\ len(data\_h)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00451}00451\ \ \ \ \ \ \ \ \ \ \ histograms\ =\ histograms\ +\ data\_h}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00452}00452\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00453}00453\ \ \ \ \ \ \ \ \ k\ =\ k\ +\ 1}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00454}00454\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00455}00455\ \ \ \ \ df\ =\ pd.DataFrame(\{\textcolor{stringliteral}{'Value'}:\ histograms,\ \textcolor{stringliteral}{'Category'}:\ categories\})}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00456}00456\ \ \ \ \ fig\ =\ px.histogram(df,\ x=\textcolor{stringliteral}{"{}Value"{}},\ color=\textcolor{stringliteral}{"{}Category"{}},\ nbins=1023,\ opacity=0.75)}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00457}00457\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00458}00458\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae0b4629d635715a95dc81941afc8cc5d}{datas\_fit\_xs}})):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00459}00459\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ j\ \textcolor{keywordflow}{in}\ range(len(self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae0b4629d635715a95dc81941afc8cc5d}{datas\_fit\_xs}}[i])):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00460}00460\ \ \ \ \ \ \ \ \ fig.add\_trace(}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00461}00461\ \ \ \ \ \ \ \ \ \ \ go.Scatter(}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00462}00462\ \ \ \ \ \ \ \ \ \ \ \ \ x=self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ae0b4629d635715a95dc81941afc8cc5d}{datas\_fit\_xs}}[i][j],\ y=self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a4c25699507abbc7d92b9d880472fe99a}{datas\_fit\_ys}}[i][j],\ mode=\textcolor{stringliteral}{'lines'},\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00463}00463\ \ \ \ \ \ \ \ \ \ \ \ \ name=f\textcolor{stringliteral}{"{}FID:\{i\},\ HID:\{j\},\ (\{self.calib\_means[i]:3.2f\},\ \{self.calib\_sigmas[i]:3.2f\})"{}},\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00464}00464\ \ \ \ \ \ \ \ \ \ \ \ \ line=dict(color=\textcolor{stringliteral}{'black'},\ width=1.5),\ opacity=0.5))}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00465}00465\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00466}00466\ \ \ \ \ fig.show()}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00467}00467\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00468}\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a4167ef1d85c186d2ba00a19d4e07c617}{00468}}\ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a4167ef1d85c186d2ba00a19d4e07c617}{draw\_gain\_curve}}(self):}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00469}00469\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00476}00476\ \ \ \ \ fig\ =\ go.Figure(}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00477}00477\ \ \ \ \ \ \ data\ =\ go.Scatter(}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00478}00478\ \ \ \ \ \ \ \ \ x=self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_ac7ec4c3e66f37706b483e8e0ae322569}{voltages}},\ y=self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a7c3020e476ac1e1d25358d8a3b49f103}{G}},\ }
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00479}00479\ \ \ \ \ \ \ \ \ error\_y=dict(type=\textcolor{stringliteral}{'data'},\ array=self.\mbox{\hyperlink{classcatmlib_1_1analyser_1_1mcaanalysis_1_1_t_multi_channel_analyzer_a66b915780d1e66c39030fb17deea07da}{G\_err}},\ thickness=2,\ width=5,\ visible=\textcolor{keyword}{True}),}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00480}00480\ \ \ \ \ \ \ \ \ name=\textcolor{stringliteral}{'fitted\ data\ plot'}))}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00481}00481\ \ \ \ \ fig.update\_layout(title=\textcolor{stringliteral}{'Gain\ Curve'},\ yaxis\_title=\textcolor{stringliteral}{'Gain'},\ xaxis\_title=\textcolor{stringliteral}{'Voltage\ [V]'},\ title\_x=0.05,\ title\_font=dict(size=20))}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00482}00482\ \ \ \ \ \textcolor{comment}{\#\ fig.add\_trace(}}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00483}00483\ \ \ \ \ \textcolor{comment}{\#\ \ \ go.Scatter(}}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00484}00484\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ x=np.array(self.calib\_means),\ y=self.linear(np.array(self.calib\_means),\ self.b\ ,\ self.a),\ mode='lines',\ }}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00485}00485\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ name=f"{}\{self.b:.3f\}+\{self.a:.3f\}x"{},\ }}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00486}00486\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ line=dict(color='red',\ width=2),\ opacity=0.5))}}
\DoxyCodeLine{\Hypertarget{mcaanalysis_8py_source_l00487}00487\ \ \ \ \ fig.show()}

\end{DoxyCode}
